var content=function(){"use strict";var M=Object.defineProperty;var N=(c,o,a)=>o in c?M(c,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[o]=a;var l=(c,o,a)=>N(c,typeof o!="symbol"?o+"":o,a);var m,v;function c(r){return r}const o={matches:["*://*.google.com/*"],main(){console.log("Hello content.")}},a=((v=(m=globalThis.browser)==null?void 0:m.runtime)==null?void 0:v.id)==null?globalThis.chrome:globalThis.browser;function h(r,...e){}const S={debug:(...r)=>h(console.debug,...r),log:(...r)=>h(console.log,...r),warn:(...r)=>h(console.warn,...r),error:(...r)=>h(console.error,...r)},f=class f extends Event{constructor(e,t){super(f.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=t}};l(f,"EVENT_NAME",y("wxt:locationchange"));let g=f;function y(r){var e;return`${(e=a==null?void 0:a.runtime)==null?void 0:e.id}:content:${r}`}function E(r){let e,t;return{run(){e==null&&(t=new URL(location.href),e=r.setInterval(()=>{let s=new URL(location.href);s.href!==t.href&&(window.dispatchEvent(new g(s,t)),t=s)},1e3))}}}const u=class u{constructor(e,t){l(this,"isTopFrame",window.self===window.top);l(this,"abortController");l(this,"locationWatcher",E(this));l(this,"receivedMessageIds",new Set);this.contentScriptName=e,this.options=t,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return a.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,t){const s=setInterval(()=>{this.isValid&&e()},t);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(e,t){const s=setTimeout(()=>{this.isValid&&e()},t);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(e){const t=requestAnimationFrame((...s)=>{this.isValid&&e(...s)});return this.onInvalidated(()=>cancelAnimationFrame(t)),t}requestIdleCallback(e,t){const s=requestIdleCallback((...i)=>{this.signal.aborted||e(...i)},t);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(e,t,s,i){var n;t==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(n=e.addEventListener)==null||n.call(e,t.startsWith("wxt:")?y(t):t,s,{...i,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),S.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:u.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){var n,d,w;const t=((n=e.data)==null?void 0:n.type)===u.SCRIPT_STARTED_MESSAGE_TYPE,s=((d=e.data)==null?void 0:d.contentScriptName)===this.contentScriptName,i=!this.receivedMessageIds.has((w=e.data)==null?void 0:w.messageId);return t&&s&&i}listenForNewerScripts(e){let t=!0;const s=i=>{if(this.verifyScriptStartedEvent(i)){this.receivedMessageIds.add(i.data.messageId);const n=t;if(t=!1,n&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}};l(u,"SCRIPT_STARTED_MESSAGE_TYPE",y("wxt:content-script-started"));let b=u;const I=Symbol("null");let T=0;class K extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[e]=arguments;if(e!=null){if(typeof e[Symbol.iterator]!="function")throw new TypeError(typeof e+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[t,s]of e)this.set(t,s)}}_getPublicKeys(e,t=!1){if(!Array.isArray(e))throw new TypeError("The keys parameter must be an array");const s=this._getPrivateKey(e,t);let i;return s&&this._publicKeys.has(s)?i=this._publicKeys.get(s):t&&(i=[...e],this._publicKeys.set(s,i)),{privateKey:s,publicKey:i}}_getPrivateKey(e,t=!1){const s=[];for(let i of e){i===null&&(i=I);const n=typeof i=="object"||typeof i=="function"?"_objectHashes":typeof i=="symbol"?"_symbolHashes":!1;if(!n)s.push(i);else if(this[n].has(i))s.push(this[n].get(i));else if(t){const d=`@@mkm-ref-${T++}@@`;this[n].set(i,d),s.push(d)}else return!1}return JSON.stringify(s)}set(e,t){const{publicKey:s}=this._getPublicKeys(e,!0);return super.set(s,t)}get(e){const{publicKey:t}=this._getPublicKeys(e);return super.get(t)}has(e){const{publicKey:t}=this._getPublicKeys(e);return super.has(t)}delete(e){const{publicKey:t,privateKey:s}=this._getPublicKeys(e);return!!(t&&super.delete(t)&&this._publicKeys.delete(s))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new K;function P(){}function p(r,...e){}const _={debug:(...r)=>p(console.debug,...r),log:(...r)=>p(console.log,...r),warn:(...r)=>p(console.warn,...r),error:(...r)=>p(console.error,...r)};return(async()=>{try{const{main:r,...e}=o,t=new b("content",e);return await r(t)}catch(r){throw _.error('The content script "content" crashed on startup!',r),r}})()}();
content;
